<div class="container mt-4">
  <div class="row">
    <div class="col-sm-4">
        <h4>Редакция на обява</h4>
    </div>
  </div>
  <div class="row">
    <div *ngIf="editForm?.dirty || descriptionForm?.dirty" class="col alert alert-info">
      <strong>Информация:</strong> Вие направихте промени. Всички незапазени промени ще бъдат изтрити!
    </div>
  </div>
  <div class="row mb-4">
    <div class="col-sm-4"> <!-- left part -->
      <div class="card">
        <img src="{{ad.photoUrl !== null ? ad.photoUrl : 'assets/img/default.jpg'}}" alt="{{ad.id}}" class="card-img-top img-thumbnail" style="width:350px;height:350px;">
        <!-- <div class="card-body">
          <div>
            <strong>Заглавие:</strong> {{ad.title}}
          </div>
          <div>
            <strong>Цена: </strong>
            <span *ngIf="ad.price == null;else show_price">
              По договаряне
            </span>
            <ng-template #show_price>
              {{ad.price === 0 ? 'Безплатно' : ((ad.price | number : '1.2-2') + ' лв.')}}
            </ng-template>
          </div>
          <div>
            <strong>Адрес:</strong> {{ad.location}}
          </div>
          <div>
            <strong>Категория:</strong> {{ad.categoryName}}
          </div>
          <div>
            <strong>Добавена:</strong> {{ad.dateAdded | date}}
          </div>
          <div *ngIf="ad?.isUsed != null">
            <strong>Състояние: </strong> {{ ad?.isUsed ? 'използвано' : 'ново'}}
          </div>
        </div> -->
        <div class="card-body" *ngIf="!this.adTabs.tabs[2].active"> <!-- class="card-footer" -->
          <div class="btn-group d-flex">
            <button *ngIf="this.adTabs.tabs[0].active" [disabled]="!editForm?.dirty" form="editForm" class="btn btn-success btn-block">Редактирай</button>
            <button *ngIf="this.adTabs.tabs[1].active" [disabled]="!descriptionForm?.dirty" form="descriptionForm" class="btn btn-success btn-block">Редактирай</button>
          </div>
        </div>
      </div>
    </div>
    <div class="col-sm-8"> <!-- right part -->
      <div class="tab-panel">
        <tabset class="ad-tabset" #adTabs>
            <tab heading="Детайли" (selectTab)="resetForm('description')">
                <form #editForm="ngForm" id="editForm" name="editForm" (ngSubmit)="updateAd()">
                    <h6>Заглавие на обявата</h6>
                    <input type="text" class="form-control" name="title" [(ngModel)]="ad.title">
                    <h6 class="mt-2">Категория</h6>
                    <select class="form-control" [(ngModel)]="ad.categoryId" name="categoryId" (change)="onCategorySelect()">
                      <option *ngFor="let category of categories" [ngValue]="category.id">{{category.name}}</option>
                    </select>
                    <h6 class="mt-2">Адрес</h6>
                    <input type="text" class="form-control" name="location" [(ngModel)]="ad.location">
                    <h6 class="mt-2">Цена</h6>
                    <input type="number" class="form-control" name="price" [(ngModel)]="ad.price" min="0" step="0.01" placeholder="По договаряне" oninput="validity.valid||(value='');">
                    <h6 class="mt-2">Състояние</h6>
                    <select class="form-control" [(ngModel)]="ad.isUsed" name="isUsed">
                      <option [ngValue]="false">ново</option>
                      <option [ngValue]="true">използвано</option>
                      <option [ngValue]="null">неопределено</option>
                    </select>
                </form>
            </tab>
            <tab heading="Описание" (selectTab)="resetForm('details')">
              <form #descriptionForm="ngForm" id="descriptionForm" name="descriptionForm" (ngSubmit)="updateAd()">
                <textarea class="form-control" name="description" rows="10" [(ngModel)]="ad.description" pre></textarea>
              </form>
            </tab>
            <tab heading="Снимки" (selectTab)="resetForm('both')">
              <app-photo-editor [photos]="ad.photos" [adId]="ad.id" (getAdPhotoChange)="updateMainPhoto($event)"></app-photo-editor>
            </tab>
        </tabset>
      </div>
    </div>
  </div>
</div>
